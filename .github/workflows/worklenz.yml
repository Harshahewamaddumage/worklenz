yaml 
CopyEdit 
name:  CI/CD for Worklenz 
 
on: 
  push: 
    branches: 
      - main 
  pull_request: 
    branches: 
      - main 
 
env: 
  FRONTEND_DIR: worklenz-frontend 
  BACKEND_DIR: worklenz-backend 
  GHCR_REPO: ghcr.io/${{ github.repository }} 
  FRONTEND_IMAGE: ghcr.io/${{ github.repository_owner 
}}/worklenz-frontend:latest 
  BACKEND_IMAGE: ghcr.io/${{ github.repository_owner }}/worklenz
backend:latest 
 
jobs: 
  build-and-push: 
    runs-on: ubuntu-latest 
 
    steps: 
    - name: üì• Checkout Code 
      uses: actions/checkout@v4 
 
    - name: üîê Login to GitHub Container Registry 
      run: echo "${{ secrets.GHCR_PAT }}" | docker login ghcr.io -u ${{ github.actor }} --password-stdin 
 
    # Backend Docker Build & Push 
    - name: üê≥ Build & Push Backend Image 
      uses: docker/build-push-action@v5 
      with: 

       
        context: ./worklenz-frontend 
        push: true 
        tags: ${{ env.FRONTEND_IMAGE }} 
      
      
        context: ./worklenz-backend 
        push: true 
        tags: ${{ env.BACKEND_IMAGE }} 
 

 

 
    steps: 
    - name: üöÄ Deploy to Azure Web App 
      uses: azure/webapps-deploy@v3 
      with: 
        app-name: ${{ secrets.AZURE_WEBAPP_NAME }} 
        publish-profile: ${{ secrets.AZURE_PUBLISH_PROFILE }} 
        images: | 
          ${{ env.BACKEND_IMAGE }} 
          ${{ env.FRONTEND_IMAGE }}

      - name: üì¶ Build and Push Docker image
        uses: docker/build-push-action@v5
        with:
          context: ./worklenz-frontend
          file: ./worklenz-frontend/Dockerfile
          push: true
          tags: |
            ghcr.io/harshahewamaddumage/worklenz_frontend:latest
            ghcr.io/harshahewamaddumage/worklenz_frontend:${{ github.sha }}

